Спринт 2

ЗАДАЧА

```
1. Клонируем репозиторий, собираем его на сервере srv.
Исходники простого приложения можно взять здесь. Это простое приложение на Django с уже написанным Dockerfile. 
Приложение работает с PostgreSQL, в самом репозитории уже есть реализация docker-compose — её можно брать за 
референс при написании Helm-чарта. Необходимо склонировать репозиторий выше к себе в Git и настроить пайплайн 
с этапом сборки образа и отправки его в любой docker registry. Для пайплайнов можно использовать GitLab, 
Jenkins или GitHub Actions — кому что нравится. Рекомендуем GitLab.

2. Описываем приложение в Helm-чарт.
Описываем приложение в виде конфигов в Helm-чарте. По сути, там только два контейнера — с базой и приложением, 
так что ничего сложного в этом нет. Стоит хранить данные в БД с помощью PVC в Kubernetes.

3. Описываем стадию деплоя в Helm.
Настраиваем деплой стадию пайплайна. Применяем Helm-чарт в наш кластер. Нужно сделать так, чтобы наше приложение 
разворачивалось после сборки в Kubernetes и было доступно по бесплатному домену или на IP-адресе с выбранным портом.
Для деплоя должен использоваться свежесобранный образ. По возможности нужно реализовать сборку из тегов в Git, где 
тег репозитория в Git будет равен тегу собираемого образа. Чтобы создание такого тега запускало пайплайн на сборку 
образа c таким именем hub.docker.com/skillfactory/testapp:2.0.3.
```

Создаем в корне проекта папку CICD и клонируем исходники приложения ```https://github.com/vinhlee95/django-pg-docker-tutorial```

Проверяем  Dockerfile исправляем ошибки, разрешаем подключения с хостов в settings.py 
```
ALLOWED_HOSTS = ['*']
DEBUG = True
```
Подсовываем enventory file: 
```
DB_HOST=
DB_NAME=
DB_USER=
DB_PASS=
POSTGRES_DB=
POSTGRES_USER=
POSTGRES_PASSWORD=
```
Проверяем запуск через ``` docker-compose up -d ```

![image](https://github.com/usmanofff/CICD/assets/74288450/51ecb3ef-8a9d-490d-a736-f7a10bd90086)

Проверем ```curl localhost:3003 ``` приложение должно отвечать.

![image](https://github.com/usmanofff/CICD/assets/74288450/064125a2-c453-476a-8c61-c317d44ab44e)

Если все запустилось останавливаем контейнеры ``` docker stop $(docker ps -qa) ``` 

Далее будем описывать CI-CD процесс сборки и деплоя в Doker-registry для этого будем использовать gitlab.

Создаем учетку на DockerHub и логинемся командой:

```Docker login``` 


![image](https://github.com/usmanofff/CICD/assets/74288450/c06121a4-5c15-4f26-a48f-218c16110918)

В проекте создал отдельную папку для gitlab 

Создаем проект в gitlab : ``` https://gitlab.com/sfc_diplom/app ```















